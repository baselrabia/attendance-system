<html>

<head>
    <title>Attendance System</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    
    <!-- --------------------------------------------- -->
    <script src="js/JQuery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script>
         $(document).ready(function () {
                //  console.log(data);
                data = JSON.parse(localStorage.getItem("users"));
                //console.log(data)

                // td
                var requests = JSON.parse(localStorage.getItem("users"));
                //console.log(requests);

                var html = "<table class='table table-bordered table-sm' border='1|1'>";
                var html = `<thead class="text-center" > 
                                <th  >username </th>
                               <th  >firstname </th>
                               <th  >lastname </th>
                               <th  >address </th>
                               <th  >email </th>
                               <th  >age </th>
                               <th  >password </th>
                               <th  >new </th>
                               <th  >verify </th>
                               <th  >Delete </th>

                    </thead>
                    <tbody>`
                for (var i = 0; i < requests.length; i++) {
                    if (requests[i].new == true) {

                        html += "<tr class='text-center' id='user" + i + "'>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].username + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].firstname + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].lastname + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].address + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].email + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].age + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].password + "</td>";
                        html += "<td class='w-25 p-3 col small'>" + requests[i].new + "</td>";
                        html += "<td class='w-25 p-3 col small'>"
                            + "<button class='btn p-0 bg-transparent' onclick='add(this)' >"
                            + '<i class="fa fa-check text-success"></i>' + "</button>"
                        html += "</td>";
                        html += "<td class='w-25 p-3 col small'>"
                            + "<button  class='btn p-0 bg-transparent' onclick='remove(this)' >"
                            + '<i class="fa fa-remove text-danger  "></i>' + "</button>" + "</td>";
                        html += "</tr>";

                    }
                }
                html += "</tbody></table>";
                document.getElementById("box").innerHTML = html;
                //$('#box').innerHTML = html;
                //document.getElementById("boxdiv").appendChild(html); 


                // Remove Fun


                remove = function (target) {
                    // console.log(((target.parentElement).parentElement).rowIndex - 1);

                    var row = (target.parentElement).parentElement;
                    var index = row.getAttribute('id').slice(4);
                    // console.log(index);
                    requests.splice(index, 1);
                    row.parentNode.removeChild(row);
                    localStorage.setItem("users", JSON.stringify(requests))
                    location.reload();


                }
                add = function (target) {
                    // console.log(((target.parentElement).parentElement).rowIndex - 1);
                    var row = (target.parentElement).parentElement;
                    var index = row.getAttribute('id').slice(4);
                    requests[index].new = false;
                    //var newData = requests.array.splice(index, 1)[0];
                    //data.push(newData);


                    row.parentNode.removeChild(row);
                    localStorage.setItem("users", JSON.stringify(requests));
                    location.reload();

                    //saveJSONFile(data, "data.json")

                }

                // function saveJSONFile(data, filename) {
                //     var dataToSave = new Blob([JSON.stringify(data)], {
                //         type: "application/json"
                //     });
                //     var link = document.createElement("a");
                //     link.href = window.webkitURL.createObjectURL(dataToSave);
                //     link.setAttribute("download", filename);
                //     document.getElementsByTagName("body")[0].appendChild(link);
                //     link.click();
                //     $(link).remove();
                // }
            })

    </script>
</head>


<body>
    <div class="container">


        <nav class="navbar navbar-expand-lg navbar-light ">
            <a class="navbar-brand " href="index.html"><b>Attandance System </b></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end " id="navbarSupportedContent">
                <ul class="navbar-nav ">
                    <li class="nav-item active">
                        <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/AdminPanel.html">admin panel</a>
                    </li>


            </div>
        </nav>
    </div>


    <section class="noti-box mt-5">
        <div class="container-fluid ">
            <div class="row justify-content-center">
                <div class="col-10">
                    <h5 class="text-capitalize mb-4">notification</h5>
                </div>
                <div class="col-md-10">
                    <div class="table-responsive noti-items p-1" id="boxdiv">
                        <table class="table table-bordered table-sm" id="box">


                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    
</body>

</html>

</html>